services:
  cloudstation:
    build: .
    container_name: cloudstation-pro
    ports:
      - "9999:9999"
    env_file:
      - ./data/.env
    environment:
      - PORT=9999
      - DATA_PATH=/data
      - CONTAINER_NAME=cloudstation-pro
      - DRIVE_PATH=/drive
      - MOUNT_BROWSE_ROOT=/host
      - SFTP_HOST_MOUNT_ROOT=${MOUNT_PATH:-/data}
      # TRUENAS_*, GEMINI_*, MOUNT_PATH come from env_file (./data/.env) only
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ./data:/data
      - .:/project
      - ${MOUNT_PATH:-/data}:/drive
      - /:/host:ro
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: unless-stopped
